module quadrature_3d_xyoz_mod_test
  implicit none

contains

  @test
  subroutine test_quadrature_3d_xyoz()

    use pFUnit_Mod

    use quadrature_3d_xyoz_mod, only: quadrature_3d_xyoz_type, quadrature_3d_xyoz_proxy_type
    use constants_mod,  only : r_def
    use quadrature_rule_gaussian_mod, only: quadrature_rule_gaussian_type

    integer, parameter :: nqp_1d=3, nqp_xy=9, nqp_z=3

    real(kind=r_def) :: epsilon

    real(kind=r_def) :: xqp_z(nqp_z), xqp_xy(2,nqp_xy)
    real(kind=r_def) :: wqp_z(nqp_z), wqp_xy(nqp_xy)

    real(kind=r_def) :: test_xqp_z(nqp_z), test_xqp_xy(2,nqp_xy)
    real(kind=r_def) :: test_wqp_z(nqp_z), test_wqp_xy(nqp_xy)

    type(quadrature_3d_xyoz_type)       :: qr
    type(quadrature_3d_xyoz_proxy_type) :: qr_proxy

    type(quadrature_rule_gaussian_type) :: gaussian_quadrature

    qr = quadrature_3d_xyoz_type(nqp_1d, gaussian_quadrature)

    epsilon = 1.0e-14_r_def

    test_xqp_z(:)    = [1.127016653792583E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        8.872983346207417E-001_r_def]

    test_xqp_xy(1,:) = [1.127016653792583E-001_r_def, &
                        1.127016653792583E-001_r_def, &
                        1.127016653792583E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        8.872983346207417E-001_r_def, &
                        8.872983346207417E-001_r_def, &
                        8.872983346207417E-001_r_def]

    test_xqp_xy(2,:) = [1.127016653792583E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        8.872983346207417E-001_r_def, &
                        1.127016653792583E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        8.872983346207417E-001_r_def, &
                        1.127016653792583E-001_r_def, &
                        5.000000000000000E-001_r_def, &
                        8.872983346207417E-001_r_def]

    test_wqp_z(:)    = [2.777777777777763E-001_r_def, &
                        4.444444444444444E-001_r_def, &
                        2.777777777777763E-001_r_def]

    test_wqp_xy(:)   = [7.716049382715970E-002_r_def, &
                        1.234567901234561E-001_r_def, &
                        7.716049382715970E-002_r_def, &
                        1.234567901234561E-001_r_def, &
                        1.975308641975309E-001_r_def, &
                        1.234567901234561E-001_r_def, &
                        7.716049382715970E-002_r_def, &
                        1.234567901234561E-001_r_def, &
                        7.716049382715970E-002_r_def]

    qr_proxy = qr%get_proxy()

    xqp_z = qr_proxy%xqp_z
    @assertEqual( xqp_z, test_xqp_z, epsilon )

    xqp_xy = qr_proxy%xqp_xy
    @assertEqual( xqp_xy, test_xqp_xy, epsilon )

    wqp_z = qr_proxy%wqp_z
    @assertEqual( wqp_z, test_wqp_z, epsilon )

    wqp_xy = qr_proxy%wqp_xy
    @assertEqual( wqp_xy, test_wqp_xy, epsilon )

  end subroutine test_quadrature_3d_xyoz

end module quadrature_3d_xyoz_mod_test
