module quadrature_3d_xoyoz_mod_test
  implicit none

contains

  @test
  subroutine test_quadrature_3d_xoyoz()

    use pFUnit_Mod

    use quadrature_3d_xoyoz_mod, only: quadrature_3d_xoyoz_type, quadrature_3d_xoyoz_proxy_type
    use constants_mod,  only : r_def
    use quadrature_rule_gaussian_mod, only: quadrature_rule_gaussian_type

    integer, parameter :: nqp_1d=3, nqp_x=3, nqp_y=3, nqp_z=3

    real(kind=r_def) :: epsilon

    real(kind=r_def) :: xqp_x(nqp_x), xqp_y(nqp_y), xqp_z(nqp_z)
    real(kind=r_def) :: wqp_x(nqp_x), wqp_y(nqp_y), wqp_z(nqp_z)

    real(kind=r_def) :: test_xqp_x(nqp_x), test_xqp_y(nqp_y), test_xqp_z(nqp_z)
    real(kind=r_def) :: test_wqp_x(nqp_x), test_wqp_y(nqp_y), test_wqp_z(nqp_z)

    type(quadrature_3d_xoyoz_type)       :: qr
    type(quadrature_3d_xoyoz_proxy_type) :: qr_proxy

    type(quadrature_rule_gaussian_type) :: gaussian_quadrature

    qr = quadrature_3d_xoyoz_type(nqp_1d, gaussian_quadrature)

    epsilon = 1.0e-14_r_def

    test_xqp_x(:) = [1.127016653792583E-001_r_def, &
                     5.000000000000000E-001_r_def, &
                     8.872983346207417E-001_r_def]

    test_xqp_y(:) = test_xqp_x(:)

    test_xqp_z(:) = test_xqp_x(:)

    test_wqp_x(:) = [2.777777777777763E-001_r_def, &
                     4.444444444444444E-001_r_def, &
                     2.777777777777763E-001_r_def]

    test_wqp_y(:) = test_wqp_x(:)

    test_wqp_z(:) = test_wqp_x(:)


    qr_proxy = qr%get_proxy()

    xqp_x = qr_proxy%xqp_x
    @assertEqual( xqp_x, test_xqp_x, epsilon )

    xqp_y = qr_proxy%xqp_y
    @assertEqual( xqp_y, test_xqp_y, epsilon )

    xqp_z = qr_proxy%xqp_z
    @assertEqual( xqp_z, test_xqp_z, epsilon )

    wqp_x = qr_proxy%wqp_x
    @assertEqual( wqp_x, test_wqp_x, epsilon )

    wqp_y = qr_proxy%wqp_y
    @assertEqual( wqp_y, test_wqp_y, epsilon )

    wqp_z = qr_proxy%wqp_z
    @assertEqual( wqp_z, test_wqp_z, epsilon )

  end subroutine test_quadrature_3d_xoyoz

end module quadrature_3d_xoyoz_mod_test
