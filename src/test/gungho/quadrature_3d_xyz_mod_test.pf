module quadrature_3d_xyz_mod_test
  implicit none

contains

  @test
  subroutine test_quadrature_3d_xyz()

    use pFUnit_Mod

    use quadrature_3d_xyz_mod, only: quadrature_3d_xyz_type, quadrature_3d_xyz_proxy_type
    use constants_mod,  only : r_def
    use quadrature_rule_gaussian_mod, only: quadrature_rule_gaussian_type

    integer, parameter :: nqp_1d=3, nqp_xyz=27

    real(kind=r_def) :: epsilon

    real(kind=r_def) :: xqp_xyz(3,nqp_xyz)
    real(kind=r_def) :: wqp_xyz(nqp_xyz)

    real(kind=r_def) :: test_xqp_xyz(3,nqp_xyz)
    real(kind=r_def) :: test_wqp_xyz(nqp_xyz)

    type(quadrature_3d_xyz_type)       :: qr
    type(quadrature_3d_xyz_proxy_type) :: qr_proxy

    type(quadrature_rule_gaussian_type) :: gaussian_quadrature

    qr = quadrature_3d_xyz_type(nqp_1d, gaussian_quadrature)

    epsilon = 1.0e-14_r_def
 
    test_xqp_xyz(1,:) = [1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def]

    test_xqp_xyz(2,:) = [1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         8.872983346207417E-001_r_def]

    test_xqp_xyz(3,:) = [1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def, &
                         1.127016653792583E-001_r_def, &
                         5.000000000000000E-001_r_def, &
                         8.872983346207417E-001_r_def]

    test_wqp_xyz(:)   = [2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         5.486968449931384E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         5.486968449931384E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         5.486968449931384E-002_r_def, &
                         8.779149519890260E-002_r_def, &
                         5.486968449931384E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         5.486968449931384E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         5.486968449931384E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def, &
                         3.429355281207098E-002_r_def, &
                         2.143347050754425E-002_r_def]

    qr_proxy = qr%get_proxy()

    xqp_xyz = qr_proxy%xqp_xyz
    @assertEqual( xqp_xyz, test_xqp_xyz, epsilon )

    wqp_xyz = qr_proxy%wqp_xyz
    @assertEqual( wqp_xyz, test_wqp_xyz, epsilon )

  end subroutine test_quadrature_3d_xyz

end module quadrature_3d_xyz_mod_test
